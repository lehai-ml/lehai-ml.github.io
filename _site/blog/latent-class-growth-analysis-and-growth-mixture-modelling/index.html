<!DOCTYPE html>

<html lang="en" class="h-100">

<head>

  
  
  

  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:type" content="website">
  <meta property="og:title" content="Latent Class Growth Analysis and Growth Mixture Modelling">
  <meta property="og:description" content="">
  <meta property="og:image" content="https://avatars.githubusercontent.com/u/60798941?v=4">

  <title>Latent Class Growth Analysis and Growth Mixture Modelling</title>
  <meta name="description" content="">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico">

  <!-- Theme style -->
  <script src="/assets/js/theme.js"></script>

  <!-- Font Awesome CDN -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.10.0/css/all.css">

  <!-- Bootstrap CSS CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">

  <!-- Animate CSS CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/assets/css/style.css">

</head>

<body class="h-100 d-flex flex-column">

  <main class="flex-shrink-0 container mt-5">
    <nav class="navbar navbar-expand-lg navbar-themed">

  <!-- <a class="navbar-brand" href="/"><h5><b>Hai Anh Le</b></h5></a> -->

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fas fa-1x fa-bars text-themed"></i>
  </button>

  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav ml-auto"><a class="nav-item nav-link active" href="/"></a>

      <a class="nav-item nav-link " href="/about/">About</a>

      <a class="nav-item nav-link active" href="/blog/">Blog</a>

      <a class="nav-item nav-link " href="/projects/">Projects</a>

      

      <span id="theme-toggler" class="nav-item nav-link" role="button" onclick="toggleTheme()"></span>
    </div>
  </div>

</nav>
    <div class="col-lg-10 mx-auto mt-5 markdown-body">
    <h1><b>Latent Class Growth Analysis and Growth Mixture Modelling</b></h1>

<p class="post-metadata text-muted">
  19 March 2025 -  
  <b>5 mins read time</b>

  <br>Tags: 
    
    <a class="text-decoration-none no-underline" href="/blog/tags#statistics">
      <span class="tag badge badge-pill text-primary border border-primary">statistics</span>
    </a>
    
    <a class="text-decoration-none no-underline" href="/blog/tags#r">
      <span class="tag badge badge-pill text-primary border border-primary">r</span>
    </a>
    
    <a class="text-decoration-none no-underline" href="/blog/tags#clustering">
      <span class="tag badge badge-pill text-primary border border-primary">clustering</span>
    </a>
    </p>

<h1 id="introduction">Introduction</h1>

<p>Clustering is the task of grouping set of data into subgroups, such that data points within a subgroup (a cluster) is similar to each other but is different from other subgroups. However, clustering algorithm such as K-means clustering does not necessarily consider the temporal aspect of the data.</p>

<p>Growth mixture modelling (GMM) and Latent Class Growth Analysis (LCGA) are two types of longitudional modelling techniques that identify <em>homogenous</em> subpopulations based on growth trajectories. In medical research, the tools can be applied to study the different developmental trajectories within a population.</p>

<p><br />
<br /></p>

<blockquote>
  <blockquote>
    <p><em>A useful framework for beginning to understand latent class analysis and growth mixture modelling is the distinction between person-centred and variable-centred approaches. Variable-centred approaches such as regression […] focuses on describing the relationships among variables. The goal is to identify significant predictors of outcomes, and describe how dependent and independent variables are related. Person-centred approaches, on the other hand, include methods such as cluster analysis, latent class analysis, and finite mixture modelling. The focus is on the relationships among indiviudals, and the goal is to classify individuals into distinct groups or categories based on individual response patterns</em><a href="#1">[1]</a>.</p>
  </blockquote>
</blockquote>

<p><br />
<br /></p>

<p>One example that I am very interested in was this paper by Bandoli et al. <a href="#2">[2]</a>, where the authors have examine whether patterns of prenatal alcohol exposure differentially affect dysphormic features in infants.</p>

<blockquote>
  <p><img src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/cda1/7722075/69e1f92bc02a/nihms-1629488-f0001.jpg" alt="" /></p>
</blockquote>

<p>Here, using longitudinal modelling, the authors found 5 distinct trajectories of development, which corresponded to high sustaiend, moderate/high, low/moderate sustained, low/moderate and minimal/no prenatal alcohol exposure. Dysmorphology score was then calculated and examined for association with trajectory of prenatal alcohol exposure.</p>

<h2 id="example">Example</h2>

<p>The following two tutorials explain quite clearly how to carry out LCGA and GMM in R <a href="#3">[3,4]</a>. You can also use the following tutorial to generate some simulated data here <a href="#5">[5]</a>.</p>

<p>Suppose you have a data for 100 cases, each with 5 equally spaced repeated measures on a continuous outcome scale (total of 500 data points).</p>

<p><img src="/assets/images/trajectory_clustering/example_lcga.jpg" alt="" /></p>

<p>Suppose we are now interested in separating this underlying dataset into sub-populations, where individuals within the same group have very similar trajectories.</p>

<p>In R, both LCGA and GMM can be accomplished with the <code class="language-plaintext highlighter-rouge">flemix</code> package. Below is an example with LCGA,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lcga_fit &lt;- stepFlexmix(. ~ .|ID,
k = 1:5,
nrep = 100,
model = FLXMRglmfix(y ~ time, varFix = T),
data = mydata,
control = list(iter.max = 500, minprior = 0))
</code></pre></div></div>

<p>This code will try out different configurations of the data, and allows us to choose the best fit model. Of interest to us are the following parameters:</p>

<ul>
  <li>k-&gt; the number of latent subpopulations we want the model to test.</li>
  <li>nrep -&gt; number of random initialisation. Here, the model can find a local minima, but may not be the most optimal output.</li>
</ul>

<p>In all model configurations, we have fitted <code class="language-plaintext highlighter-rouge">y</code> as the dependent variable of <code class="language-plaintext highlighter-rouge">time</code>. The error variance is the same in all data groups.</p>

<p>Example output:</p>

<table>
  <thead>
    <tr>
      <th>iter</th>
      <th>converged</th>
      <th>k</th>
      <th>Integrated Completed Likelihood</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>True</td>
      <td>1</td>
      <td>2311.291</td>
    </tr>
    <tr>
      <td>5</td>
      <td>True</td>
      <td>2</td>
      <td>1788.269</td>
    </tr>
    <tr>
      <td>10</td>
      <td>True</td>
      <td>3</td>
      <td>1784.632</td>
    </tr>
    <tr>
      <td>34</td>
      <td>True</td>
      <td>4</td>
      <td>1776.328</td>
    </tr>
    <tr>
      <td>29</td>
      <td>True</td>
      <td>5</td>
      <td>1776.853</td>
    </tr>
  </tbody>
</table>

<p>This table indicates that the model can converge at all 5 different configurations. Using a model fit measure such as the integrated completed likelihood (or Akaike information criterion), we can decide which model we want (here, the lower the score the better). For example, here we can examine the models with two and four latent subpopulations, as the differences between the model fit measures in k=1 and k=2 is most dramatic, and there is not much difference between k=4 and k=5.</p>

<p>The package also allows us to check the posterior probability of the cluster assignments.</p>

<div style="display: flex; gap: 20px; flex-wrap: wrap; justify-content: center;">

  <div style="flex: 1; min-width: 300px;">
    
<table>
  <thead>
    <tr>
      <th> </th>
      <th>prior</th>
      <th>size</th>
      <th>post&gt;0</th>
      <th>ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Comp.1</td>
      <td>0.5</td>
      <td>250</td>
      <td>265</td>
      <td>0.943</td>
    </tr>
    <tr>
      <td>Comp.2</td>
      <td>0.5</td>
      <td>250</td>
      <td>255</td>
      <td>0.980</td>
    </tr>
  </tbody>
</table>

  </div>

  <div style="flex: 1; min-width: 300px;">
    
<table>
  <thead>
    <tr>
      <th> </th>
      <th>prior</th>
      <th>size</th>
      <th>post&gt;0</th>
      <th>ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Comp.1</td>
      <td>0.318</td>
      <td>160</td>
      <td>250</td>
      <td>0.640</td>
    </tr>
    <tr>
      <td>Comp.2</td>
      <td>0.234</td>
      <td>120</td>
      <td>255</td>
      <td>0.471</td>
    </tr>
    <tr>
      <td>Comp.3</td>
      <td>0.266</td>
      <td>130</td>
      <td>245</td>
      <td>0.531</td>
    </tr>
    <tr>
      <td>Comp.4</td>
      <td>0.181</td>
      <td>90</td>
      <td>230</td>
      <td>0.391</td>
    </tr>
  </tbody>
</table>

  </div>

</div>

<div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">

  <img src="/assets/images/trajectory_clustering/two_cluster_rootgram.jpg" alt="Two clusters" style="max-width: 45%; height: auto;" />

  <img src="/assets/images/trajectory_clustering/four_cluster_rootgram.jpg" alt="Four clusters" style="max-width: 45%; height: auto;" />

</div>

<p>Focusing on the result on the left, the model with two latent subpopulations indicates that equal number of observations were assigned to cluster 1 and cluster 2. Furthermore, the high ratio in either components indicates there is a high confidence of membership. This is, however, not the case for the model on the right. Although the model fit score is lower in this configuration, the rootograms indicate that compared to the first model, this model cannot reliably differentiate between the four clusters.</p>

<p>This is more evident when we plot the cluster memberships for each observation as follows</p>

<div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">

  <img src="/assets/images/trajectory_clustering/two_clusters_trajectory.jpg" alt="Two clusters" style="max-width: 45%; height: auto;" />

  <img src="/assets/images/trajectory_clustering/four_clusters_trajectory.jpg" alt="Four clusters" style="max-width: 45%; height: auto;" />

</div>

<p>Thus, this suggests that the data would be better fit with a 2 latent population configurations. Next, we can examine whether the cluster membership is associated with any other covariates of interest, such as age, gender or demographic information.</p>

<h1 id="references">References</h1>
<p><a id="1"></a> [1] <a href="https://www.statmodel.com/download/JungWickramaLCGALGMM.pdf">Jung and Wickrama. An Introduction to Latent Class Growth analysis and Growth Mixture Modeling</a></p>

<p><a id="2"></a> [2] <a href="https://pubmed.ncbi.nlm.nih.gov/32772389/">Bandoli <em>et al</em>, 2020. Patterns of Prenatal Alcohol Exposure and Alcohol-Related Dysmorphic Features</a></p>

<p><a id="3"></a> [3] <a href="https://www.youtube.com/watch?v=cqnpN1k1mPk&amp;ab_channel=RegorzStatistik">https://www.youtube.com/watch?v=cqnpN1k1mPk&amp;ab_channel=RegorzStatistik</a></p>

<p><a id="4"></a> [4] <a href="https://www.youtube.com/watch?v=sQfIeOh3rJQ&amp;ab_channel=RegorzStatistik">https://www.youtube.com/watch?v=sQfIeOh3rJQ&amp;ab_channel=RegorzStatistik</a></p>

<p><a id="5"></a> [5] <a href="https://www.youtube.com/redirect?event=video_description&amp;redir_token=QUFFLUhqbnViVWpJdUhXRkhQSjFUc1JpRUdRLUJlRGtfUXxBQ3Jtc0ttQ0lYT2x4Z1k0UWV1UlVzeF9oajV3cWRPNXMtRHNlTl9mS05mdUZkcWtQRjlrdUhGM3pjRW9PUlJnYm9BcTY0cHRCcXM5U3I4LTNvaFFyaTdRb0NNeTVnQV9DZHhTZTNkT3ZCcHpCVW8zaGVoLXZDYw&amp;q=https%3A%2F%2Fpsyarxiv.com%2Fm58wx%2Fdownload%3Fformat%3Dpdf&amp;v=cqnpN1k1mPk">Wardenaar, K. (2020). Latent Class Growth Analysis and Growth Mixture Modeling using R: A tutorial for two R-packages and a comparison with Mplus</a></p>




</div>
  </main>
  <footer class="mt-auto py-3 text-center">

  <small class="text-muted mb-2">
    Made with <i class="fas fa-heart"></i>
    by <strong>Hai</strong>
  </small>
  
</footer>

  <!-- GitHub Buttons -->
<script async defer src="https://buttons.github.io/buttons.js"></script>

<!-- jQuery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Popper.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>

<!-- Bootstrap JS CDN -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- wow.js CDN & Activation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.js"></script>
<script> new WOW().init(); </script>

<!-- Initialize all tooltips -->
<script>
$(function () {
    $('[data-toggle="tooltip"]').tooltip()
})
</script>

<!-- Initialize math equations-->
<script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      },
      svg: {
        fontCache: 'global'
      }
    };
  </script>
  <script type="text/javascript" async
    src="https://polyfill.io/v3/polyfill.min.js?features=es6">
  </script>
  <script type="text/javascript" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
  

</body>

</html>